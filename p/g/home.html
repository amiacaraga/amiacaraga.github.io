<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMIA Caraga MIS</title>
    <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/photos-cd20a.appspot.com/o/success-stories.jpg?alt=media&token=a021fe5d-6964-4d9e-92c2-4b4f27ddcee3" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://amia-caraga.github.io/site/p/g/success-stories"/>
  <link rel="stylesheet" href="../../vendors/feather/feather.css">
  <link rel="stylesheet" href="../../vendors/ti-icons/css/themify-icons.css">
  <link rel="stylesheet" href="../../vendors/css/vendor.bundle.base.css">
  <link rel="stylesheet" href="../../css/vertical-layout-light/style.css">
  <link rel="shortcut icon" href="../../images/favicon.png" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: white;
        }

        .navbar {
            display: flex;
            justify-content: space-around;
            background-color: #FDA92A;
            padding: 1rem;
        }

        .navbar a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .navbar a:hover {
            background-color: white;
            color: #FDA92A;
        }

        .logout-button {
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 90px;
        }

        .logout-button:hover {
            background-color: #cc0000;
        }

        .content {
            padding: 2rem;
            text-align: center;
        }

        .home, .success-story, .job-opportunity, .success-story-form, .job-opportunity-form {
            display: none;
        }

        .active {
            display: block;
        }

        form {
            width: 100%;
            max-width: 600px;
            background-color: #fff;
            padding: 40px;
            padding-right: 60px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
            text-align: left;
        }

        h2 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 5px;
            color: #333;
            font-weight: bold;
        }

        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }

        textarea {
            resize: vertical;
        }

        button {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            background-color: #FDA92A;
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #b6710a;
        }

        table {
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
            border-collapse: collapse;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        table th, table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        table th {
            background-color: #f4f4f4;
            font-weight: bold;
        }

        .delete-button {
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .delete-button:hover {
            background-color: #cc0000;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="#home" onclick="showSection('home')">Home</a>
        <a href="#success-story" onclick="showSection('success-story')">Success Story</a>
        <a href="#job-opportunity" onclick="showSection('job-opportunity')">Job Opportunity</a>
        <button class="logout-button" onclick="logout()">Logout</button>
    </nav>

    <div class="content">
        <div id="home" class="home active">
            <div class="content-wrapper">
                <div class="row mb-3">
                  <div class="col-md-12 grid-margin mb-3">
                    <div class="row">
                      <div class="col-12 col-xl-8 mb-3 mb-xl-2">
                        <h3 class="font-weight-bold">Adaptation and Mitigation Initiative in Agriculture</h3>
                        <h6 class="font-weight-normal mb-0"><span class="text-primary">Building farming and fishing communities, livelihoods, and enterprises resilient to economic and climate shocks.</span></h6>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="row">
                  <div class="col-md-6 mb-3 stretch-card">
                    <div class="card tale-bg">
                        <div class="card-people">
                            <img class="w-100" src="../../images/logos/people.svg" alt="people">
                            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                              <img src="transparent.png" style="width: 100%; height: 100%; opacity: 0;">
                          </div>
                        </div>
                    </div>
                  </div>
                  <div class="col-md-6 mb-0 grid-margin transparent">
                    <div class="row mb-0 ">
                      <div class="col-md-6 mb-3 stretch-card transparent">
                        <div class="card card-tale">
                          <div class="card-body">
                            <p class="mb-4">The AMIA Approach can be adopted in DA Programs towards climate-risk based planning & delivery of interventions.</p>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6 mb-3 stretch-card transparent">
                        <div class="card card-dark-blue">
                          <div class="card-body">
                            <p class="mb-4">AMIA is a building block for the Farm & Fisheries Clustering & Consolidation (F2C2) Program.</p>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-6 mb-3 stretch-card transparent mb-0">
                        <div class="card card-light-blue">
                          <div class="card-body">
                            <p class="mb-4">Transformation of climate-resilient communities into climate-resilient business enterprises.</p>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6 mb-3 stretch-card transparent mb-0">
                        <div class="card card-light-danger">
                          <div class="card-body">
                            <p class="mb-4">Climate-risk based deployment of technologies and tailor-fitted & integrated support services.</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                  
                  <div class="col-md-12 grid-margin stretch-card mb-0">
                    <div class="mcard">
                        <blockquote class="">
                          <p class="mb-0 abc">The <b>AMIA program</b> envisions the Philippines where all communities, especially those dependent on agriculture and fisheries, would become resilient to the increasing adverse effects of climate change.​</p>
                    </div>
                  </div>
                  <div class="col-md-12 grid-margin stretch-card mb-0">
                    <div class="mcard">
                        <blockquote class="">
                          <p class="mb-0 abc">In pursuit of this vision, the program has set up communities called AMIA Villages, which serve as “go-to places” or lighthouses where farmers learn different climate resilient agriculture practices and technologies, helping them avoid, adjust, and recover from the impacts of climate change.​</p>
                    </div>
                  </div>
                  
                  
              <!-- main-panel ends -->
            
              <!-- content-wrapper ends -->
              <!-- partial:partials/_footer -->
              
              <!-- partial -->
          <!-- page-body-wrapper ends -->
        </div>
        </div>
        <div id="success-story" class="success-story">
            <h1>Success Stories</h1>
            <p>Read about our success stories here.</p>
            <button onclick="showSection('success-story-form')">Add Your Success Story</button>
        </div>
        <div id="job-opportunity" class="job-opportunity">
            <h1>Job Opportunities</h1>
            <p>Explore job opportunities with us.</p>
            <button onclick="showSection('job-opportunity-form')">Add Job Opportunity</button>
        </div>
        <div id="success-story-form" class="success-story-form">
            <h2 style="color: #FDA92A;">Success Story Data Management</h2>
            <form>
                <div class="form-group">
                    <label for="image">Image Link</label>
                    <input type="text" id="image" placeholder="https://example.com/image.png"><br>
                </div>
                <div class="form-group">
                    <label for="title">Title</label>
                    <input type="text" id="title" placeholder="Title should not exceed 25 words."><br>
                </div>
                <div class="form-group">
                    <label for="date">Date</label>
                    <input type="date" id="date"><br>
                </div>
                <div class="form-group">
                    <label for="author">Author</label>
                    <input type="text" id="author" placeholder="Author"><br>
                </div>
                <div class="form-group">
                    <label for="office">Office</label>
                    <input type="text" id="office" placeholder="Office"><br>
                </div>
                <div class="form-group">
                    <label for="description">Description</label>
                    <input type="text" id="description" placeholder="Description should not exceed 25 words."><br>
                </div>
                <div class="form-group">
                    <label for="content">Content</label>
                    <input type="text" id="content" placeholder="Content should not exceed 3000 words."><br>
                </div>
                <div class="form-group">
                    <button type="button" id="insert-story">Insert</button>
                </div>
            </form>

            <table id="data-table-story">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Author</th>
                        <th>Date</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div id="job-opportunity-form" class="job-opportunity-form">
            <h2 style="color: #FDA92A;">Job Posting Data Management</h2>
            <form>
                <div class="form-group">
                    <label for="postingNumber">Posting Number</label>
                    <input type="text" id="postingNumber" placeholder="Posting Number"><br>
                </div>
                <div class="form-group">
                    <label for="assignment">Place of Assignment</label>
                    <input type="text" id="assignment" placeholder="Place of Assignment"><br>
                </div>
                <div class="form-group">
                    <label for="position">Position</label>
                    <input type="text" id="position" placeholder="Position"><br>
                </div>
                <div class="form-group">
                    <label for="salaryGrade">Salary Grade</label>
                    <input type="text" id="salaryGrade" placeholder="Salary Grade"><br>
                </div>
                <div class="form-group">
                    <label for="deadline">Deadline of Submission</label>
                    <input type="date" id="deadline"><br>
                </div>
                <div class="form-group">
                    <label for="link">File Google Drive Link</label>
                    <input type="text" id="link" placeholder="https://drive.google.example"><br>
                </div>
                <div class="form-group">
                    <button type="button" id="insert-job">Insert</button>
                </div>
            </form>

            <table id="data-table-job">
                <thead>
                    <tr>
                        <th>Assignment</th>
                        <th>Position</th>
                        <th>Salary Grade</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-auth.js"></script>
    <script>// Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBvCo3oKxF7VaGyvqzcXl4BYEYmzgAkyVM",
            authDomain: "amia-caraga-website.firebaseapp.com",
            databaseURL: "https://amia-caraga-website-default-rtdb.firebaseio.com",
            projectId: "amia-caraga-website",
            storageBucket: "amia-caraga-website.appspot.com",
            messagingSenderId: "725656270766",
            appId: "1:725656270766:web:008b5df732b3d35dd0fa3f",
            measurementId: "G-SP922RR158"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        var imageV, titleV, dateV, authorV, officeV, descriptionV, contentV;
        var postingNumberV, assignmentV, positionV, salaryGradeV, deadlineV, linkV;

        // Success Stories Functions
        function readStoryForm() {
            imageV = document.getElementById("image").value;
            titleV = document.getElementById("title").value;
            dateV = document.getElementById("date").value;
            authorV = document.getElementById("author").value;
            officeV = document.getElementById("office").value;
            descriptionV = document.getElementById("description").value;
            contentV = document.getElementById("content").value;
        }

        function deleteStoryData(uid, storyKey) {
            firebase.database().ref(`users/${uid}/stories/${storyKey}`).remove()
                .then(() => {
                    return firebase.database().ref(`publicStories/${storyKey}`).remove();
                })
                .then(() => {
                    document.getElementById(storyKey).remove();
                    alert("Data Deleted");
                })
                .catch(error => {
                    console.error("Error deleting data: ", error);
                });
        }

        function insertStoryData() {
            readStoryForm();
            const user = firebase.auth().currentUser;
            if (user) {
                const uid = user.uid;
                const newStoryRef = firebase.database().ref(`users/${uid}/stories`).push();
                const newStoryKey = newStoryRef.key;

                const storyData = {
                    image: imageV,
                    title: titleV,
                    date: dateV,
                    author: authorV,
                    office: officeV,
                    description: descriptionV,
                    content: contentV,
                };

                const updates = {};
                updates[`users/${uid}/stories/${newStoryKey}`] = storyData;
                updates[`publicStories/${newStoryKey}`] = storyData;

                firebase.database().ref().update(updates).then(() => {
                    alert("Data Inserted");

                    // Add data to the table only if it's not already there
                    if (!document.getElementById(newStoryKey)) {
                        var table = document.getElementById("data-table-story").getElementsByTagName('tbody')[0];
                        var newRow = table.insertRow();
                        newRow.setAttribute("id", newStoryKey);
                        newRow.innerHTML = `
                            <td>${titleV}</td>
                            <td>${authorV}</td>
                            <td>${dateV}</td>
                            <td><button class="delete-button" onclick="deleteStoryData('${uid}', '${newStoryKey}')">Delete</button></td>
                        `;
                    }

                    document.getElementById("image").value = "";
                    document.getElementById("title").value = "";
                    document.getElementById("date").value = "";
                    document.getElementById("author").value = "";
                    document.getElementById("office").value = "";
                    document.getElementById("description").value = "";
                    document.getElementById("content").value = "";
                }).catch(error => {
                    console.error("Error inserting data: ", error);
                });
            } else {
                alert("No user is signed in.");
            }
        }

        function displayStoryData() {
            const user = firebase.auth().currentUser;
            if (user) {
                const uid = user.uid;
                firebase.database().ref(`users/${uid}/stories`).on("value", function(snapshot) {
                    var table = document.getElementById("data-table-story").getElementsByTagName('tbody')[0];
                    table.innerHTML = ""; // Clear existing table data
                    snapshot.forEach(function(childSnapshot) {
                        var childData = childSnapshot.val();
                        var newRow = table.insertRow();
                        newRow.setAttribute("id", childSnapshot.key);
                        newRow.innerHTML = `
                            <td>${childData.title}</td>
                            <td>${childData.author}</td>
                            <td>${childData.date}</td>
                            <td><button class="delete-button" onclick="deleteStoryData('${uid}', '${childSnapshot.key}')">Delete</button></td>
                        `;
                    });
                });
            } else {
                alert("No user is signed in.");
            }
        }

        // Job Opportunities Functions
        function readJobForm() {
            postingNumberV = document.getElementById("postingNumber").value;
            assignmentV = document.getElementById("assignment").value;
            positionV = document.getElementById("position").value;
            salaryGradeV = document.getElementById("salaryGrade").value;
            deadlineV = document.getElementById("deadline").value;
            linkV = document.getElementById("link").value;
        }

        function deleteJobData(uid, postingNumber) {
            firebase.database().ref(`users/${uid}/jobs/${postingNumber}`).remove()
                .then(() => {
                    return firebase.database().ref(`publicJobs/${postingNumber}`).remove();
                })
                .then(() => {
                    document.getElementById(postingNumber).remove();
                    alert("Data Deleted");
                })
                .catch(error => {
                    console.error("Error deleting data: ", error);
                });
        }

        function insertJobData() {
            readJobForm();
            const user = firebase.auth().currentUser;
            if (user) {
                const uid = user.uid;
                const newJobData = {
                    postingNumber: postingNumberV,
                    assignment: assignmentV,
                    position: positionV,
                    salaryGrade: salaryGradeV,
                    deadline: deadlineV,
                    link: linkV,
                };

                // Save job data under the user's node
                firebase.database().ref(`users/${uid}/jobs/${postingNumberV}`).set(newJobData)
                    .then(() => {
                        // Also save job data under the publicJobs node
                        return firebase.database().ref(`publicJobs/${postingNumberV}`).set(newJobData);
                    })
                    .then(() => {
                        alert("Data Inserted");

                        // Add data to the table only if it's not already there
                        if (!document.getElementById(postingNumberV)) {
                            var table = document.getElementById("data-table-job").getElementsByTagName('tbody')[0];
                            var newRow = table.insertRow();
                            newRow.setAttribute("id", postingNumberV);
                            newRow.innerHTML = `
                                <td>${assignmentV}</td>
                                <td>${positionV}</td>
                                <td>${salaryGradeV}</td>
                                <td><button class="delete-button" onclick="deleteJobData('${uid}', '${postingNumberV}')">Delete</button></td>
                            `;
                        }

                        document.getElementById("postingNumber").value = "";
                        document.getElementById("assignment").value = "";
                        document.getElementById("position").value = "";
                        document.getElementById("salaryGrade").value = "";
                        document.getElementById("deadline").value = "";
                        document.getElementById("link").value = "";
                    })
                    .catch(error => {
                        console.error("Error inserting data: ", error);
                    });
            } else {
                alert("No user is signed in.");
            }
        }

        function displayJobData() {
            const user = firebase.auth().currentUser;
            if (user) {
                const uid = user.uid;
                firebase.database().ref(`users/${uid}/jobs`).on("value", function(snapshot) {
                    var table = document.getElementById("data-table-job").getElementsByTagName('tbody')[0];
                    table.innerHTML = ""; // Clear existing table data
                    snapshot.forEach(function(childSnapshot) {
                        var childData = childSnapshot.val();
                        var newRow = table.insertRow();
                        newRow.setAttribute("id", childSnapshot.key);
                        newRow.innerHTML = `
                            <td>${childData.assignment}</td>
                            <td>${childData.position}</td>
                            <td>${childData.salaryGrade}</td>
                            <td><button class="delete-button" onclick="deleteJobData('${uid}', '${childSnapshot.key}')">Delete</button></td>
                        `;
                    });
                });
            } else {
                alert("No user is signed in.");
            }
        }

        function showSection(sectionId) {
            document.querySelectorAll('.content > div').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }

        document.getElementById("insert-story").onclick = insertStoryData;
        document.getElementById("insert-job").onclick = insertJobData;

        // Display existing data on load
        window.onload = function() {
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    displayStoryData();
                    displayJobData();
                } else {
                    window.location.href = "login.html";
                }
            });
        };

        function logout() {
            firebase.auth().signOut().then(() => {
                window.location.href = "login.html";
            }).catch((error) => {
                console.error("Sign out error:", error);
            });
        }</script>
</body>
</html>

    